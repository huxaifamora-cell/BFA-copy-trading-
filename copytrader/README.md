# âš¡ CopyTrader v4 â€” Web-Based MT5 Copy Trading Platform

A fully self-hosted MT5 copy trading platform where **users never touch MetaTrader**. They sign up on your website, enter their broker credentials, choose Master or Follower â€” and the server runs MT5 automatically for them in the background.

---

## How It Works

```
User signs up on website
        â†“
Enters MT5 login + broker server
        â†“
Chooses: Master (publish) or Follower (copy)
        â†“
Server launches a headless MT5 instance (Wine + Xvfb on Linux)
EA is auto-injected and configured
        â†“
Trades copy automatically â€” user never touches MT5 again
```

**No MetaEditor. No EA installation. No VPS for users.**

---

## Features

- ğŸŒ **Fully web-based** â€” works on mobile and desktop browsers
- ğŸ” **User accounts** â€” JWT auth, bcrypt passwords
- ğŸ¤– **Auto MT5 management** â€” per-user headless MT5 via Wine + Xvfb
- ğŸ”’ **Encrypted credentials** â€” AES-256-GCM at rest
- ğŸ“Š **Live dashboard** â€” open trades, P&L, status per account
- ğŸ“‹ **Trade history** â€” win rate, pips, best/worst trade
- ğŸ‘¥ **Subscription gating** â€” master approves followers
- ğŸ“¡ **Multi-channel** â€” one user can run multiple channels
- ğŸš€ **One-command VPS setup** â€” full production install in minutes

---

## Quick Start

### 1. Get a VPS

Recommended: **Hetzner CPX31** (~$15/month) â€” 8GB RAM, 4 vCPU, Ubuntu 22.04.
Each MT5 instance uses ~300MB RAM. This handles ~20 concurrent users comfortably.

### 2. Clone & Deploy

```bash
git clone https://github.com/YOUR_USERNAME/copytrader-mt5.git
cd copytrader-mt5
chmod +x setup_vps.sh
sudo bash setup_vps.sh
```

The script installs Node.js, Wine, Xvfb, downloads MT5, generates secrets, and starts the server with PM2.

### 3. Open the website

```
http://YOUR_VPS_IP:3000
```

### 4. Users sign up and connect

Users go to your website, create an account, click **Add Account**, enter their MT5 credentials and broker server â€” done. The server launches MT5 for them automatically.

---

## User Journey

### Master (signal provider)
1. Sign up on the website
2. Click **Add Account** â†’ choose **Master**
3. Enter MT5 login + broker server
4. Get a **6-digit channel code** automatically
5. Share the code â€” followers connect instantly

### Follower
1. Sign up on the website
2. Click **Add Account** â†’ choose **Follower**
3. Enter MT5 login + broker server + channel code
4. Choose lot sizing mode
5. Done â€” trades copy automatically

---

## Tech Stack

| Component | Technology |
|-----------|-----------|
| Web server | Node.js + Express |
| Database | SQLite (WAL mode) |
| Auth | JWT + bcrypt |
| Encryption | AES-256-GCM |
| MT5 runtime | Wine (on Linux) |
| Virtual display | Xvfb |
| Process manager | PM2 |
| Frontend | Vanilla JS SPA |

---

## Project Structure

```
copytrader-mt5/
â”œâ”€â”€ server/
â”‚   â”œâ”€â”€ index.js        # Main server â€” auth, accounts, trade API
â”‚   â”œâ”€â”€ mt5manager.js   # Per-user MT5 instance lifecycle
â”‚   â”œâ”€â”€ crypto.js       # AES-256-GCM credential encryption
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ public/
â”‚       â””â”€â”€ index.html  # Full web app (SPA)
â”œâ”€â”€ setup_vps.sh        # One-command Ubuntu 22.04 setup
â””â”€â”€ README.md
```

---

## Environment Variables (auto-generated by setup_vps.sh)

| Variable | Description |
|----------|-------------|
| `PORT` | HTTP port (default: 3000) |
| `ENCRYPTION_SECRET` | AES key for credential encryption (32+ chars) |
| `JWT_SECRET` | JWT signing secret |
| `INSTANCES_DIR` | Where per-user MT5 Wine prefixes are stored |
| `MT5_INSTALLER` | Path to mt5setup.exe |
| `EA_SOURCE` | Path to compiled CopyTrader_Cloud.ex5 |
| `SERVER_URL` | Public URL of this server |

---

## Security

- All MT5 passwords encrypted with AES-256-GCM before database storage
- JWT tokens expire after 7 days
- Rate limiting on auth endpoints (10 req/min)
- Each MT5 instance runs in an isolated Wine prefix
- **Recommended for production:** run behind nginx with Let's Encrypt HTTPS

```bash
apt install nginx certbot python3-certbot-nginx
certbot --nginx -d yourdomain.com
```

---

## Scaling

| Users | RAM needed | Recommended VPS |
|-------|-----------|----------------|
| 1â€“10  | 4â€“6 GB   | Hetzner CX31 |
| 10â€“30 | 8â€“12 GB  | Hetzner CPX41 |
| 30â€“80 | 16â€“32 GB | Hetzner CCX33 |

For larger scale, run multiple VPS servers and load-balance with nginx.

---

## Contributing

Pull requests welcome. Open an issue before large changes.

```bash
git checkout -b feature/your-feature
git commit -m "feat: your change"
git push origin feature/your-feature
```

---

## License

MIT â€” free to use, modify, and distribute.

---

## Disclaimer

This software automates trading using credentials provided by users. Users must consent to credential storage. You are responsible for compliance with applicable financial regulations in your jurisdiction. Use at your own risk.
